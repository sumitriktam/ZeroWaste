{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body{
           
            background: linear-gradient(
        rgba(255, 255, 255, 0.9), /* Start with a faded white color */
        rgba(255, 255, 255, 0.8) /* End with the same faded white color */
      ),
      url('/statics/provider/images/zerowastebg.jpg') center center no-repeat; /* Specify your background image URL and center it */
    
        }
        #graph-container {
            margin-top: 10%;
            width: 70%; 
            margin-left:15%;
        }
        .top-left-text {
    font-size: 24px;
    font-weight: bold;
    color: #333;
    position: absolute;
    left: 69px; /* X-axis */
    top: 30px; /* Y-axis */
}
.req-name {
    color: #1D710F;
    font-size: 24px;
    font-weight: bold;
    font-family: 'Inter', Arial, Helvetica, sans-serif;
    width: 157px;
    height: 50px;
    position: absolute;
    top: 130px;
    left: 80px;
}
.navbar {
    position: absolute;
    left: 700px;
    top: 40px;
    width: 647px;
    height: 55px;
    border-radius: 20px;
    background-color: #D9D9D9;
}

.navbar ul {
    position:relative;
    list-style: none;
    padding: 0;
    margin: 0;
    top:18px;
    left:50px;
    display: flex;
    justify-content: center;
}

.navbar li {
    margin-right: 100px;
}

.navbar a {
    text-decoration: none;
    color: #333;
    font-weight: bold;
    font-size: 16px;
}

/* Profile circle styles */
.circle {
    width: 53px;
    height: 50px;
    background-color: #D9D9D9;
    border-radius: 50%;
    position: absolute;
    left: 1370px;
    top: 45px;
    text-align: center;
}
.image {
    position: absolute;
    left: 22px;
    top: 48px;
    width: 40px;
    height: 37px;   
}
.modal {
    display: none;
    align-items: center;
    justify-content: center;
    position: fixed;
    top: 0%;
    left: 0;
    width: 100%;
    height: 100%;
    backdrop-filter: blur(3px);
    background: rgba(0, 0, 0, 0.5); /* Transparent black overlay */
    z-index: 1;
}

/* Popup content */
.modal-content {
    display: block;
    position:absolute;
    width:40%;
    height:30%;
    left:30%;
    top:35%;
    background-color:#ffffff /* Use rgba for opacity */;
    font-weight: 500;
    font-size: 16px;
    border-radius: 10px;
}
.logout:hover{
    cursor: pointer;
    color:red;
}
.text_logout{
    position:relative;
    left:5%;
    top:10%;
    margin-bottom:4%;
}
.user{
    position:absolute;
    top:30%;
    left:35%;
    font-size: 20px;
    cursor:pointer;
}
.button_logout{
    position: relative;
    left:60%;
    top:18%;
    margin-right:15px;
    height:16%;
    width:16%;
    border-radius: 8px;
    cursor: pointer;
    color:#ffffff;
    font-size: 100%;
    border:none;
}
.button_logout:hover{
   border:2px solid black;
}
/* Close button */
.close {
    position:absolute;
    left:95.5%;
    top:4%;
    color:white;
    font-weight: 3px;
    width:3.5%;
    height:8%;
    font-size:20px;
    border:none;
    cursor: pointer;;
}

.close:hover{
    color: black;
    text-decoration: none;
    cursor: pointer;
    border: 1.8px solid black;
}
@media only screen and (max-width: 1024px) {
    .modal-content{
        width:40%;
        height:20%;
    }
    .button_logout{
        top:15%;
    }
}
    </style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
</head>
<body>
    
    <img src="/statics/admin/media/simple-icons_overleaf.png" alt="Your Image" class="image">
        <p class="top-left-text" >ZeroWaste</p>
        <nav class="navbar">
            <!-- Add your navbar content here -->
            <ul>
                <li><a href="#home">Home</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#feedback">Feedback</a></li>
                <li> <button onclick="display_logout()" style="border:none; background-color:#D9D9D9;font-weight:bold;font-size:16px;" class="logout">Logout</button> </li>
                <div id="popup-modal" class="modal">
                    <div class="modal-content">
                        <span class="close" style="background-color:red" onclick="closePopup()"><i class="fas fa-times" style="position:absolute;left:15%;"></i></span>
                        <p style="font-size:145%; font-weight:bold;" class="text_logout">LogOut</p>
                        <p style="font-size:120%;" class="text_logout">Are you sure,do you want to logout?</p>
                        <button class="button_logout" style="background-color:#0084FF;" onclick="closePopup()">Cancel</button>
                        <button class="button_logout" style="background-color:red;"> <a href="{% url 'provider:logout' %}" style="text-decoration:none;color:#ffffff">Log Out</a> </button>
                    </div>
            </ul>
        </nav>
        <div class="circle"><i class="fa fa-user user" aria-hidden="true"></i></div>
       
        <div class="req-name">
            <p >
                <a style ="color: #1D710F;text-decoration: none;" href="/provider/home">
                    <i class="fas fa-arrow-left icon-with-space" style="font-size: 20px;"></i>
                </a>Your Performance</p>
        </div>
    <div id="graph-container">
        <canvas id="zeroWasteChart" width="800" height="400"></canvas>
    </div>
    

    <script>
        

    const scores = JSON.parse('{{ score_json | escapejs }}');
    const dates = JSON.parse('{{ date_json | escapejs }}');
        
    
    const formattedDates = dates.map(date => new Date(date));

        
    const monthYearLabels = formattedDates.map(date => {
            const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            return monthNames[date.getMonth()] + '-' + date.getFullYear();
        });

     
        const ctx = document.getElementById('zeroWasteChart').getContext('2d');
        const zeroWasteChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: monthYearLabels,
                datasets: [{
                    label: 'Zero Waste Score',
                    data: scores,
                    borderColor: scores.map((score, index) => (index > 0 && score < scores[index - 1]) ? 'red' : 'green'),
                    borderWidth: 3,
                    pointStyle: 'circle',
                    pointRadius: 6
                }]
            },
            options: {
                plugins: {
                    title: {
                        display: false
                        
                    },
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const date = formattedDates[context.dataIndex];
                                let scoreChange = '';
                                if (context.dataIndex > 0) {
                                    scoreChange = scores[context.dataIndex] - scores[context.dataIndex - 1];
                                    scoreChange = scoreChange >= 0 ? ` (+${scoreChange})` : ` (${scoreChange})`;
                                }
                                return `Score: ${scores[context.dataIndex]}${scoreChange}\nDate: ${date.toDateString()}`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        title: {
                            display: true,
                            text: 'Zero Waste Score',
                            font: {
                                size: 16
                            }
                        }
                    }
                }
            }
        });
     // Function to display the popup
function display_logout() {
    var modal = document.getElementById("popup-modal");
    modal.style.display = "block";
}

// Function to close the popup
function closePopup() {
    var modal = document.getElementById("popup-modal");
    modal.style.display = "none";
}
   
    </script>
</body>
</html>

